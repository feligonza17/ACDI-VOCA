"Inv Fort Inst",
"Inv Total",
"Reconciliacion",
"Disculpas",
"Violencia",
"Rencor",
"Memoria",
"Memoria_Expectativa")
colnames(correlaciones) <- nombres
rcorr(correlaciones, type="spearman") #Aqui hay hartas cosas!! REVISAR
dfcorrelaciones <- as.data.frame(correlaciones)
regReconcililacion <- lm(Reconciliacion ~ correlaciones[,1:5], data=dfcorrelaciones)
summary(regReconcililacion)
regDisculpas <- lm(Disculpas ~correlaciones[,1:5], data=dfcorrelaciones)
summary(regDisculpas)
regViolencia <- lm(Violencia ~correlaciones[,1:5], data=dfcorrelaciones)
summary(regViolencia)
regRencor <- lm(Rencor ~correlaciones[,1:5], data=dfcorrelaciones)
summary(regRencor)
regMemoria <- lm(Memoria~correlaciones[,1:5], data=dfcorrelaciones)
summary(regMemoria)
regMemoria_Expectativa <- lm(Memoria_Expectativa~correlaciones[,1:5],
data=dfcorrelaciones)
summary(regMemoria_Expectativa)
#Hay algunas variables que tienen valores de infinito. Vamos a reemplazarlos por valores perdidos
diff_inv_fortinst_cienmil_mean[which(!is.finite(diff_inv_fortinst_cienmil_mean))] <- NA
diff_inv_total_cienmil_mean[which(!is.finite(diff_inv_total_cienmil_mean))] <- NA
correlaciones <- cbind(diff_desemp_fisc_mean,
diff_desemp_int_mean,
diff_IGA_total_mean,
diff_inv_fortinst_cienmil_mean,
diff_inv_total_cienmil_mean,
reconciliacion_agreg$reconciliacion.mean,
disculpas_agreg$disculpas.mean,
violencia_agreg$violencia.mean,
rencor_agreg$rencor.mean,
memoria_agreg$memoria.mean,
memoria_expectativa_agreg$memoria_expectativa.mean)
nombres <- c("Desempeno Fiscal",
"Desempeno Integral",
"Gobierno Abierto",
"Inv Fort Inst",
"Inv Total",
"Reconciliacion",
"Disculpas",
"Violencia",
"Rencor",
"Memoria",
"Memoria_Expectativa")
colnames(correlaciones) <- nombres
rcorr(correlaciones, type="spearman") #Hay algo entre la diferencia entre Desempeno Fiscal y rencor.
dfcorrelaciones <- as.data.frame(correlaciones)
regReconcililacion <- lm(Reconciliacion ~ diff_desemp_fisc_mean+
diff_desemp_int_mean+
diff_IGA_total_mean+
diff_inv_fortinst_cienmil_mean+
diff_inv_total_cienmil_mean, data=dfcorrelaciones)
summary(regReconcililacion)
#Reconciliacion es el unico que parece funcionar. Pues o el unico que arroja informacion sobre esta BBDD.
regDisculpas <- lm(Disculpas ~ diff_desemp_fisc_mean+                           diff_desemp_int_mean+                           diff_IGA_total_mean+                           diff_inv_fortinst_cienmil_mean+                          diff_inv_total_cienmil_mean, data=dfcorrelaciones)
summary(regDisculpas)
regViolencia <- lm(Violencia ~ diff_desemp_fisc_mean+                           diff_desemp_int_mean+                           diff_IGA_total_mean+                           diff_inv_fortinst_cienmil_mean+                          diff_inv_total_cienmil_mean, data=dfcorrelaciones)
summary(regViolencia)
regRencor <- lm(Rencor ~ diff_desemp_fisc_mean+                           diff_desemp_int_mean+                           diff_IGA_total_mean+                           diff_inv_fortinst_cienmil_mean+                          diff_inv_total_cienmil_mean, data=dfcorrelaciones)
summary(regRencor)
regMemoria <- lm(Memoria~ diff_desemp_fisc_mean+                           diff_desemp_int_mean+                           diff_IGA_total_mean+                           diff_inv_fortinst_cienmil_mean+                          diff_inv_total_cienmil_mean, data=dfcorrelaciones)
summary(regMemoria)
regMemoria_Expectativa <- lm(Memoria_Expectativa~diff_desemp_fisc_mean+                           diff_desemp_int_mean+                           diff_IGA_total_mean+                           diff_inv_fortinst_cienmil_mean+                          diff_inv_total_cienmil_mean, data=dfcorrelaciones)
summary(regMemoria_Expectativa)
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("C:/Users/felig/ACDI-VOCA")
#render your sweet site.
rmarkdown::render_site()
correlaciones <- cbind(diff_desemp_fisc_mean,
diff_desemp_int_mean,
diff_IGA_total_mean,
diff_inv_fortinst_cienmil_mean,
diff_inv_total_cienmil_mean,
reconciliacion_agreg$reconciliacion.mean,
disculpas_agreg$disculpas.mean,
violencia_agreg$violencia.mean,
rencor_agreg$rencor.mean,
memoria_agreg$memoria.mean,
memoria_expectativa_agreg$memoria_expectativa.mean)
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("C:/Users/felig/ACDI-VOCA")
#render your sweet site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("C:/Users/felig/ACDI-VOCA")
#render your sweet site.
rmarkdown::render_site()
##Cargar paquetes
```{r message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = "C:/Users/felig/Dropbox/Proyecto Juan Camilo")
library(readstata13)
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("C:/Users/felig/ACDI-VOCA")
#render your sweet site.
rmarkdown::render_site()
######### Script para organizar las bases de datos con las que vamos a trabajar en el  ######### proyecto (aqui se hace merge de las bases CEDE con el acdivoca y se definen  ######## las variables importantes) ####################################
#install.packages("readxl")
#install.packages("readstata13")
#install.packages("tidyr")
#install.packages("dplyr")
#install.packages("doBy")
#install.packages("vtable")
#install.packages("plyr")
#install.packages("gridExtra")
#install.packages("grid")
#install.packages("ggthemes")
library(readstata13)
library(tidyr)
library(dplyr)
library(ggplot2)
library(data.table)
library(readxl)
library(doBy)
library(vtable)
library(plyr)
library(gridExtra)
library(grid)
library(purrr)
library(psych)
library(Hmisc)
library(matrixStats)
library(ggpubr)
library(vtable)
library(ggthemes)
# Importar Datos ----------------------------------------------------------
#Set Working Directory
setwd("C:/Users/felig/Dropbox/Proyecto Juan Camilo")
rm(list=ls())
#Importar datos ACDIVOCA
datos_acdivoca <- read_excel('ACDI-VOCA - Base de Datos y Tabulados_F.xlsx')
#Ojo siempre abrir desde el dropbox de Felipe Gonzalez porque se hizo el cambio de variables chaacter a numerica desde Excel.
datos_acdivoca_num <- as.data.table(
read_excel('ACDI-VOCA - Base de Datos y Tabulados_F.xlsx',sheet=2))
#Importar datos CEDE
datos_cede_generales <- read.dta13("PANEL_CARACTERISTICAS_GENERALES.dta",
encoding="latin1", fromEncoding="UTF-8",
convert.factors = TRUE,
nonint.factors=TRUE, generate.factors = TRUE)
datos_cede_conflicto <-  read.dta13("PANEL_CONFLICTO_Y_VIOLENCIA.dta",
encoding="latin1", fromEncoding="UTF-8",
convert.factors = TRUE, generate.factors = TRUE,
nonint.factors=TRUE)
datos_cede_salud <-  read.dta13("PANEL_SALUD_Y_SERVICIOS.dta",
encoding="latin1", fromEncoding="UTF-8",
convert.factors = TRUE, generate.factors = TRUE,
nonint.factors=TRUE)
datos_cede_educacion <-  read.dta13("PANEL_DE_EDUCACION.dta",
encoding="latin1", fromEncoding="UTF-8",
convert.factors = TRUE, generate.factors = TRUE,
nonint.factors=TRUE)
datos_cede_gobierno <-  read.dta13("PANEL_BUEN_GOBIERNO.dta",
encoding="latin1", fromEncoding="UTF-8",
convert.factors = TRUE, generate.factors = TRUE,
nonint.factors=TRUE)
datos_cede_tierras <-  read.dta13("PANEL_AGRICULTURA_Y_TIERRA.dta",
encoding="latin1", fromEncoding="UTF-8",
convert.factors = TRUE, generate.factors = TRUE,
nonint.factors=TRUE)
#Contar municipios dentro de las bases
length(unique(datos_cede_generales$codmpio)) # --> 1122 municipios
length(unique(datos_cede_conflicto$codmpio)) # --> 1123 municipios
length(unique(datos_cede_educacion$codmpio)) # --> 1122 municipios
length(unique(datos_cede_gobierno$codmpio)) # ---> 1123 municipios
length(unique(datos_cede_salud$codmpio)) # ---> 1258 municipios
length(unique(datos_cede_tierras$codmpio)) # ---> 1126 municipios
length(unique(datos_acdivoca$MPIO_IK))       # --> 44 municipios
#Limpiar el codigo ID de la base acdivoca. Hay ciertos municipios que empiezan con un '0' y hay que quitarlo.
datos_acdivoca$MPIO_IK <- ifelse(startsWith(datos_acdivoca$MPIO_IK,"0"),
sub("0{1}","",datos_acdivoca$MPIO_IK,
ignore.case=TRUE),
datos_acdivoca$MPIO_IK)
datos_acdivoca_num$MPIO_IK <- ifelse(startsWith(as.character(datos_acdivoca_num$MPIO_IK),"0"),
sub("0{1}","",datos_acdivoca_num$MPIO_IK, ignore.case=TRUE),
datos_acdivoca_num$MPIO_IK)
setnames(datos_acdivoca, 'MPIO_IK', 'codmpio') #Para que el merge sea mas facil
setnames(datos_acdivoca_num, 'MPIO_IK', 'codmpio')
# Meter municipio en codigo
Nombre_cod_municipio <- datos_acdivoca[,c('Municipio','codmpio')]
Nombre_cod_municipio <- datos_acdivoca_num[,c('Municipio','codmpio')]
Nombre_cod_municipio$codmpio <- as.character(Nombre_cod_municipio$codmpio)
#Eliminar las filas repetidas
Nombre_cod_municipio <- Nombre_cod_municipio[!duplicated(Nombre_cod_municipio),]
#Merge CONFLICTO con 44 municipuos (Asi queda con los mismos municipios del acdivoca)
cede_conflicto_44 <- merge(datos_cede_conflicto, Nombre_cod_municipio, by='codmpio', all.y=T)
#Merge EDUCACIOON con 44 municipuos (Asi queda con los mismos municipios del acdivoca)
cede_educacion_44 <- merge(datos_cede_educacion, Nombre_cod_municipio, by='codmpio', all.y=T)
#Merge GENERAL con 44 municipuos (Asi queda con los mismos municipios del acdivoca)
cede_general_44 <- merge(datos_cede_generales, Nombre_cod_municipio, by='codmpio', all.y=T)
#Merge GOBIERNO con 44 municipuos (Asi queda con los mismos municipios del acdivoca)
cede_gobierno_44 <- merge(datos_cede_gobierno, Nombre_cod_municipio, by='codmpio', all.y=T)
#Merge SALUD con 44 municipuos (Asi queda con los mismos municipios del acdivoca)
cede_salud_44 <- merge(datos_cede_salud, Nombre_cod_municipio, by='codmpio', all.y=T)
#Merge TIERRAS con 44 municipuos (Asi queda con los mismos municipios del acdivoca)
cede_tierras_44 <- merge(datos_cede_tierras, Nombre_cod_municipio, by='codmpio', all.y=T)
# Convertir ano en numero
cede_conflicto_44$ano <- as.Date(cede_conflicto_44$ano, '%Y', na.rm=T)
cede_general_44$ano <- as.Date(cede_general_44$ano, '%Y', na.rm=T)
# Cuadrar items ACDIVOCA --------------------------------------------------
#Recodificar valores de los items para que sean mas interpretables (codigo para los no invertidos y los invertidos) (el 1 es -2; el 2 es 1; el 3 es 0; el 4 es 1 y el 5 es 2)
datos_acdivoca_num$memoria <- datos_acdivoca_num$p075_1
datos_acdivoca_num <- datos_acdivoca_num %>%
mutate_at(c("p024_1", "p024_2", "p024_3", "p024_4", "p024_5",
"p024_6", "p024_7", "p024_8", "p053",
"p058", "memoria"),
recode, "1"=-2, "2"=-1,"4"=1,"5"=2,"3"=0) %>%
mutate_at(c("p059"), recode, "1"=2,"2"=1,
"4"=-1,"5"=-2, "3"=0)
# Pregunta p024 -- Preguntas de Reconciliacion. Todos son Directos, se suman para sacar un indice mas global.
datos_acdivoca_num$reconciliacion <- datos_acdivoca_num %>%
select(p024_1, p024_2, p024_3, p024_4, p024_5, p024_6, p024_7, p024_8) %>%
rowSums()
#Pregunta p053 -- Pregunta sobre las disculpas. Solo es una entonces good
datos_acdivoca_num$disculpas <- datos_acdivoca_num$p053
#Pregunta p058 y p059. Ambas de Violencia. La segunda tiene escala invertida. La Primera no. Se hacen los arreglos necesarios para poder sumarlas.
datos_acdivoca_num$violencia <- datos_acdivoca_num %>%
select(p058, p059) %>%
rowSums()
#Pregunta p071a y p071b. Este es chevere. indice de rencor. Se hace una formula para hablar de la "gravedad" del rencor. Un valor alto indica alta culpa, un valor bajo indica rencor.
datos_acdivoca_num$rencor <- datos_acdivoca_num %>%
select(p071_1, p071_2) %>%
dplyr::mutate(rencor=(p071_2/p071_1)*((p071_1+p071_2)/2)) %>%
select(rencor) %>%
as.matrix(sapply(., as.numeric)) %>%
as.numeric()
#Pregunta p075_1 es de memora historica.
datos_acdivoca_num$memoria <- datos_acdivoca_num$p075_1
#indice de memoria historica y expectativas cf. Bicchieri.
datos_acdivoca_num$memoria_expectativa <- datos_acdivoca_num %>%
select(p075_1, p075_2) %>%
dplyr::mutate(memoria_expectativa=(p075_2/p075_1)*((p075_1+p075_2)/2)) %>%
select(memoria_expectativa) %>%
as.matrix(sapply(., as.numeric)) %>%
as.numeric()
#Ver items y estadisticos asociados (se pueden calcular los estadisticos por aparte tambien)
vtable(data = datos_acdivoca_num[,255:260],class = T,values = T,index = T,
char.values = T,summ = (c("mean(x)","sd(x)")))
#Otra forma de ver los estadisticos
datos_acdivoca_num %>%
select(memoria, reconciliacion, disculpas,
violencia, rencor, memoria_expectativa) %>%
summary(.)
#Otra #Otra forma de ver los estadisticos
datos_acdivoca_num %>%
select(memoria, reconciliacion, disculpas,
violencia, rencor, memoria_expectativa) %>%
describe(fast = T) %>%
print()
#Collapse estadisticos por municipio
reconciliacion_agreg <- summaryBy(reconciliacion ~ Municipio,
datos_acdivoca_num, FUN=c(sum, median, mean, sd), na.rm=F )
disculpas_agreg <- summaryBy(disculpas ~ Municipio,
datos_acdivoca_num, FUN=c(sum, median, mean, sd), na.rm=F )
violencia_agreg <- summaryBy(violencia ~ Municipio,
datos_acdivoca_num, FUN=c(sum, median, mean, sd), na.rm=F )
rencor_agreg <- summaryBy(rencor ~ Municipio,
datos_acdivoca_num, FUN=c(sum, median, mean, sd), na.rm=F )
memoria_agreg <- summaryBy(memoria ~ Municipio,
datos_acdivoca_num, FUN=c(sum, median, mean, sd), na.rm=F )
memoria_expectativa_agreg <- summaryBy(memoria_expectativa ~ Municipio,
datos_acdivoca_num, FUN=c(sum, median, mean, sd), na.rm=F )
# Merge con base de datos general -----------------------------------------
#Vamos a limpiar un poco la base general para que el merge sea mas facil de entender
cede_general_44 <- cede_general_44 %>%
select(-c(Municipio)) %>% #Quitar variable que tienen las otras bases
dplyr::rename(ano_base_general=ano) #Renombrar la variable ano asociada con la base general
#Merge con las bases
cede_conflicto_44 <- merge(cede_conflicto_44, cede_general_44, by="codmpio")
cede_educacion_44 <- merge(datos_cede_educacion, cede_general_44, by='codmpio')
cede_gobierno_44 <- merge(datos_cede_gobierno, cede_general_44, by='codmpio')
cede_salud_44 <- merge(datos_cede_salud, cede_general_44, by='codmpio')
cede_tierras_44 <- merge(datos_cede_tierras, cede_general_44, by='codmpio')
#Limpiar environment
rm(datos_cede_conflicto,datos_cede_educacion,
datos_cede_generales,datos_cede_gobierno,
datos_cede_salud,datos_cede_tierras, cede_general_44)
#Codigo para guardar el environement (la base de datos), para poder importarla en otros scripts.
save.image(file="C:/Users/felig/Dropbox/Proyecto Juan Camilo/MergeBases_Environment.RData")
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("C:/Users/felig/ACDI-VOCA")
#render your sweet site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("C:/Users/felig/ACDI-VOCA")
#render your sweet site.
rmarkdown::render_site()
#render your sweet site.
rmarkdown::render_site("Merbe_bases.Rmd")
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("C:/Users/felig/ACDI-VOCA")
#render your sweet site.
rmarkdown::render_site("Merge_bases.Rmd")
reconciliacion_agreg <- summaryBy(reconciliacion ~ Municipio,
datos_acdivoca_num, FUN=c(sum, median, mean, sd), na.rm=F )
disculpas_agreg <- summaryBy(disculpas ~ Municipio,
datos_acdivoca_num, FUN=c(sum, median, mean, sd), na.rm=F )
violencia_agreg <- summaryBy(violencia ~ Municipio,
datos_acdivoca_num, FUN=c(sum, median, mean, sd), na.rm=F )
#Otra forma de ver los estadisticos
datos_acdivoca_num %>%
select(memoria, reconciliacion, disculpas,
violencia, rencor, memoria_expectativa) %>%
describe(fast = T) %>%
print()
reconciliacion_agreg <- summaryBy(reconciliacion ~ Municipio,
datos_acdivoca_num, FUN=c(sum, median, mean, sd), na.rm=F )
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = "C:/Users/felig/Dropbox/Proyecto Juan Camilo")
library(readstata13)
library(tidyr)
library(dplyr)
library(ggplot2)
library(data.table)
library(readxl)
library(doBy)
library(vtable)
library(plyr)
library(gridExtra)
library(grid)
library(purrr)
library(psych)
#Set Working Directory
setwd("C:/Users/felig/Dropbox/Proyecto Juan Camilo")
rm(list=ls())
#Importar datos ACDIVOCA
datos_acdivoca <- read_excel('ACDI-VOCA - Base de Datos y Tabulados_F.xlsx')
#Ojo siempre abrir desde el dropbox de Felipe González porque se hizo el cambio de variables chaacter a numerica desde Excel.
datos_acdivoca_num <- as.data.table(
read_excel('ACDI-VOCA - Base de Datos y Tabulados_F.xlsx',sheet=2))
#Importar datos CEDE
datos_cede_generales <- read.dta13("PANEL_CARACTERISTICAS_GENERALES.dta",
encoding="latin1", fromEncoding="UTF-8",
convert.factors = TRUE,
nonint.factors=TRUE, generate.factors = TRUE)
datos_cede_conflicto <-  read.dta13("PANEL_CONFLICTO_Y_VIOLENCIA.dta",
encoding="latin1", fromEncoding="UTF-8",
convert.factors = TRUE, generate.factors = TRUE,
nonint.factors=TRUE)
datos_cede_salud <-  read.dta13("PANEL_SALUD_Y_SERVICIOS.dta",
encoding="latin1", fromEncoding="UTF-8",
convert.factors = TRUE, generate.factors = TRUE,
nonint.factors=TRUE)
datos_cede_educacion <-  read.dta13("PANEL_DE_EDUCACION.dta",
encoding="latin1", fromEncoding="UTF-8",
convert.factors = TRUE, generate.factors = TRUE,
nonint.factors=TRUE)
datos_cede_gobierno <-  read.dta13("PANEL_BUEN_GOBIERNO.dta",
encoding="latin1", fromEncoding="UTF-8",
convert.factors = TRUE, generate.factors = TRUE,
nonint.factors=TRUE)
datos_cede_tierras <-  read.dta13("PANEL_AGRICULTURA_Y_TIERRA.dta",
encoding="latin1", fromEncoding="UTF-8",
convert.factors = TRUE, generate.factors = TRUE,
nonint.factors=TRUE)
#Contar municipios dentro de las bases
length(unique(datos_cede_generales$codmpio)) # --> 1122 municipios
length(unique(datos_cede_conflicto$codmpio)) # --> 1123 municipios
length(unique(datos_cede_educacion$codmpio)) # --> 1122 municipios
length(unique(datos_cede_gobierno$codmpio)) # ---> 1123 municipios
length(unique(datos_cede_salud$codmpio)) # ---> 1258 municipios
length(unique(datos_cede_tierras$codmpio)) # ---> 1126 municipios
length(unique(datos_acdivoca$MPIO_IK))       # --> 44 municipios
#Limpiar el código ID de la base acdivoca. Hay ciertos municipios que empiezan con un '0' y hay que quitarlo.
datos_acdivoca$MPIO_IK <- ifelse(startsWith(datos_acdivoca$MPIO_IK,"0"),
sub("0{1}","",datos_acdivoca$MPIO_IK,
ignore.case=TRUE),
datos_acdivoca$MPIO_IK)
datos_acdivoca_num$MPIO_IK <- ifelse(startsWith(as.character(datos_acdivoca_num$MPIO_IK),"0"),
sub("0{1}","",datos_acdivoca_num$MPIO_IK, ignore.case=TRUE),
datos_acdivoca_num$MPIO_IK)
setnames(datos_acdivoca, 'MPIO_IK', 'codmpio') #Para que el merge sea más fácil
setnames(datos_acdivoca_num, 'MPIO_IK', 'codmpio')
# Meter municipio en codigo
Nombre_cod_municipio <- datos_acdivoca[,c('Municipio','codmpio')]
Nombre_cod_municipio <- datos_acdivoca_num[,c('Municipio','codmpio')]
Nombre_cod_municipio$codmpio <- as.character(Nombre_cod_municipio$codmpio)
#Eliminar las filas repetidas
Nombre_cod_municipio <- Nombre_cod_municipio[!duplicated(Nombre_cod_municipio),]
#Merge CONFLICTO con 44 municipuos (Asi queda con los mismos municipios del acdivoca)
cede_conflicto_44 <- merge(datos_cede_conflicto, Nombre_cod_municipio, by='codmpio', all.y=T)
#Merge EDUCACIOON con 44 municipuos (Asi queda con los mismos municipios del acdivoca)
cede_educacion_44 <- merge(datos_cede_educacion, Nombre_cod_municipio, by='codmpio', all.y=T)
#Merge GENERAL con 44 municipuos (Asi queda con los mismos municipios del acdivoca)
cede_general_44 <- merge(datos_cede_generales, Nombre_cod_municipio, by='codmpio', all.y=T)
#Merge GOBIERNO con 44 municipuos (Asi queda con los mismos municipios del acdivoca)
cede_gobierno_44 <- merge(datos_cede_gobierno, Nombre_cod_municipio, by='codmpio', all.y=T)
#Merge SALUD con 44 municipuos (Asi queda con los mismos municipios del acdivoca)
cede_salud_44 <- merge(datos_cede_salud, Nombre_cod_municipio, by='codmpio', all.y=T)
#Merge TIERRAS con 44 municipuos (Asi queda con los mismos municipios del acdivoca)
cede_tierras_44 <- merge(datos_cede_tierras, Nombre_cod_municipio, by='codmpio', all.y=T)
# Convertir ano en numero
cede_conflicto_44$ano <- as.Date(cede_conflicto_44$ano, '%Y', na.rm=T)
cede_general_44$ano <- as.Date(cede_general_44$ano, '%Y', na.rm=T)
#Recodificar valores de los ítems para que sean más interpretables (código para los no invertidos y los invertidos) (el 1 es -2; el 2 es 1; el 3 es 0; el 4 es 1 y el 5 es 2)
datos_acdivoca_num$memoria <- datos_acdivoca_num$p075_1
datos_acdivoca_num <- datos_acdivoca_num %>%
mutate_at(c("p024_1", "p024_2", "p024_3", "p024_4", "p024_5",
"p024_6", "p024_7", "p024_8", "p053",
"p058", "memoria"),
recode, "1"=-2, "2"=-1,"4"=1,"5"=2,"3"=0) %>%
mutate_at(c("p059"), recode, "1"=2,"2"=1,
"4"=-1,"5"=-2, "3"=0)
# Pregunta p024 -- Preguntas de Reconciliacion. Todos son Directos, se suman para sacar un indice más global.
datos_acdivoca_num$reconciliacion <- datos_acdivoca_num %>%
select(p024_1, p024_2, p024_3, p024_4, p024_5, p024_6, p024_7, p024_8) %>%
rowSums()
#Pregunta p053 -- Pregunta sobre las disculpas. Solo es una entonces good
datos_acdivoca_num$disculpas <- datos_acdivoca_num$p053
#Pregunta p058 y p059. Ambas de Violencia. La segunda tiene escala invertida. La Primera no. Se hacen los arreglos necesarios para poder sumarlas.
datos_acdivoca_num$violencia <- datos_acdivoca_num %>%
select(p058, p059) %>%
rowSums()
#Pregunta p071a y p071b. Este es chevere. Indice de rencor. Se hace una formula para hablar de la "gravedad" del rencor. Un valor alto indica alta culpa, un valor bajo indica rencor.
datos_acdivoca_num$rencor <- datos_acdivoca_num %>%
select(p071_1, p071_2) %>%
dplyr::mutate(rencor=(p071_2/p071_1)*((p071_1+p071_2)/2)) %>%
select(rencor) %>%
as.matrix(sapply(., as.numeric)) %>%
as.numeric()
#Pregunta p075_1 es de memora historica.
datos_acdivoca_num$memoria <- datos_acdivoca_num$p075_1
#indice de memoria histórica y expectativas cf. Bicchieri.
datos_acdivoca_num$memoria_expectativa <- datos_acdivoca_num %>%
select(p075_1, p075_2) %>%
dplyr::mutate(memoria_expectativa=(p075_2/p075_1)*((p075_1+p075_2)/2)) %>%
select(memoria_expectativa) %>%
as.matrix(sapply(., as.numeric)) %>%
as.numeric()
#Otra forma de ver los estadisticos
datos_acdivoca_num %>%
select(memoria, reconciliacion, disculpas,
violencia, rencor, memoria_expectativa) %>%
describe(fast = T) %>%
print()
#Collapse estadisticos por municipio
reconciliacion_agreg <- summaryBy(reconciliacion ~ Municipio,
datos_acdivoca_num, FUN=c(sum, median, mean, sd), na.rm=F )
disculpas_agreg <- summaryBy(disculpas ~ Municipio,
datos_acdivoca_num, FUN=c(sum, median, mean, sd), na.rm=F )
violencia_agreg <- summaryBy(violencia ~ Municipio,
datos_acdivoca_num, FUN=c(sum, median, mean, sd), na.rm=F )
rencor_agreg <- summaryBy(rencor ~ Municipio,
datos_acdivoca_num, FUN=c(sum, median, mean, sd), na.rm=F )
memoria_agreg <- summaryBy(memoria ~ Municipio,
datos_acdivoca_num, FUN=c(sum, median, mean, sd), na.rm=F )
memoria_expectativa_agreg <- summaryBy(memoria_expectativa ~ Municipio,
datos_acdivoca_num, FUN=c(sum, median, mean, sd), na.rm=F )
# Merge con base de datos general -----------------------------------------
#Vamos a limpiar un poco la base general para que el merge sea mas facil de entender
cede_general_44 <- cede_general_44 %>%
select(-c(Municipio)) %>% #Quitar variable que tienen las otras bases
dplyr::rename(ano_base_general=ano) #Renombrar la variable ano asociada con la base general
#Vamos a limpiar un poco la base general para que el merge sea más fácil de entender
cede_general_44 <- cede_general_44 %>%
select(-c(Municipio)) %>% #Quitar variable que tienen las otras bases
dplyr::rename(ano_base_general=ano) #Renombrar la variable año asociada con la base general
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("C:/Users/felig/ACDI-VOCA")
#render your sweet site.
rmarkdown::render_site()
#render your sweet site.
rmarkdown::render_site("Violencia_graficos_analisis.Rmd")
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("C:/Users/felig/ACDI-VOCA")
#render your sweet site.
rmarkdown::render_site("Violencia_graficos_analisis.Rmd")
#render your sweet site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("C:/Users/felig/ACDI-VOCA")
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("C:/Users/felig/ACDI-VOCA")
#render your sweet site.
rmarkdown::render_site()
